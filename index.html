<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Không gian 3D toàn cảnh</title>
    <style>
      html,
      body {
        margin: 0;
        padding: 0;
        height: 100%;
        overflow: hidden;
        background: black;
        perspective: 1200px;
        cursor: grab;
        touch-action: none;
      }

      .scene {
        width: 100%;
        height: 100%;
        position: relative;
        transform-style: preserve-3d;
      }

      .space {
        width: 100%;
        height: 100%;
        position: absolute;
        top: 0;
        left: 0;
        transform-style: preserve-3d;
      }

      .star,
      .heart,
      .falling-text {
        position: absolute;
        transform-style: preserve-3d;
      }

      .star {
        background: white;
        border-radius: 50%;
        opacity: 0.8;
        animation: twinkle 2s ease-in-out infinite, floatStar 8s linear infinite;
      }

      @keyframes twinkle {
        0%,
        100% {
          opacity: 0.3;
        }
        50% {
          opacity: 1;
        }
      }

      @keyframes floatStar {
        0% {
          transform: translate(0, 0);
        }
        20% {
          transform: translate(5px, -4px);
        }
        40% {
          transform: translate(-5px, 5px);
        }
        60% {
          transform: translate(4px, -5px);
        }
        80% {
          transform: translate(-4px, 4px);
        }
        100% {
          transform: translate(0, 0);
        }
      }

      .shooting-star {
        width: 100px;
        height: 2px;
        background: linear-gradient(-45deg, white, transparent);
        animation: shooting 1.5s linear forwards;
        position: absolute;
        transform: rotate(-45deg);
        opacity: 0.8;
      }

      @keyframes shooting {
        0% {
          transform: translate(100vw, -10vh) rotate(-45deg);
          opacity: 1;
        }
        100% {
          transform: translate(-20vw, 100vh) rotate(-45deg);
          opacity: 0;
        }
      }

      .heart {
        font-size: 20px;
        user-select: none;
        animation: fallHeart linear forwards;
      }

      @keyframes fallHeart {
        to {
          transform: translateY(100vh);
          opacity: 0;
        }
      }
      .star {
        position: absolute;
        background: white;
        border-radius: 50%;
        opacity: 0.8;
        transform-style: preserve-3d;
        animation: twinkle 2s infinite ease-in-out;
      }

      @keyframes twinkle {
        0%,
        100% {
          opacity: 0.3;
        }
        50% {
          opacity: 1;
        }
      }

      .falling-text {
        font-family: Arial, sans-serif;
        font-weight: bold;
        white-space: nowrap;
        user-select: none;
        text-shadow: 0 0 5px white, 0 0 10px white;
        animation: fallText linear forwards;
      }

      @keyframes fallText {
        to {
          transform: translateY(100vh);
          opacity: 0;
        }
      }
    </style>
  </head>
  <body>
    <div class="scene">
      <div class="space" id="space"></div>
    </div>

    <script>
      const space = document.getElementById("space");

      // === Tạo ngôi sao 3D (phân bố quanh người xem) ===
      function create3DStars(count = 500, radius = 1000) {
        for (let i = 0; i < count; i++) {
          const star = document.createElement("div");
          const size = Math.random() * 2 + 1;
          star.className = "star";
          star.style.width = `${size}px`;
          star.style.height = `${size}px`;

          // Phân bố ngẫu nhiên trên hình cầu (dạng mặt cầu bao quanh người xem)
          const theta = Math.random() * 2 * Math.PI;
          const phi = Math.acos(2 * Math.random() - 1);
          const r = radius + Math.random() * 500;

          const x = r * Math.sin(phi) * Math.cos(theta);
          const y = r * Math.sin(phi) * Math.sin(theta);
          const z = r * Math.cos(phi);

          star.style.transform = `translate3d(${x}px, ${y}px, ${z}px)`;
          space.appendChild(star);
        }
      }
      // === Star Generation ===
      function createStars(count = 300) {
        for (let i = 0; i < count; i++) {
          const star = document.createElement("div");
          const size = Math.random() * 2 + 1;
          Object.assign(star.style, {
            width: `${size}px`,
            height: `${size}px`,
            top: `${Math.random() * 100}vh`,
            left: `${Math.random() * 100}vw`,
            transform: `translateZ(${Math.random() * 2000 - 1000}px)`,
          });
          star.className = "star";
          space.appendChild(star);
        }
      }

      // === Heart ===
      function createHeart() {
        const heart = document.createElement("div");
        heart.className = "heart";
        heart.textContent = "❤️";
        Object.assign(heart.style, {
          left: `${Math.random() * 100}vw`,
          top: `${Math.random() * -20}vh`,
          fontSize: `${Math.random() * 20 + 10}px`,
          color: Math.random() > 0.5 ? "red" : "pink",
          animationDuration: `${Math.random() * 5 + 5}s`,
          transform: `translateZ(${Math.random() * 2000 - 1000}px)`,
        });
        space.appendChild(heart);
        setTimeout(() => heart.remove(), 10000);
      }

      // === Falling Text ===
      const messages = [
        "Yêu Ánh♡",
        "Anh yêu em♡",
        "Nờ Đạt ♡ Nờ Ánh",
        "Tiểu hắc ♡ Tiểu bạch",
        "Love you so muchmuch♡",
      ];
      function createFallingText() {
        const text = document.createElement("div");
        text.className = "falling-text";
        text.textContent =
          messages[Math.floor(Math.random() * messages.length)];
        Object.assign(text.style, {
          left: `${Math.random() * 90}vw`,
          top: `${Math.random() * -20}vh`,
          color: Math.random() > 0.5 ? "aqua" : "hotpink",
          fontSize: `${Math.random() * 20 + 15}px`,
          animationDuration: `${Math.random() * 5 + 5}s`,
          transform: `translateZ(${Math.random() * 2000 - 1000}px)`,
        });
        space.appendChild(text);
        setTimeout(() => text.remove(), 10000);
      }

      // === Shooting Star ===
      function createShootingStar() {
        const star = document.createElement("div");
        star.className = "shooting-star";
        Object.assign(star.style, {
          top: "0",
          left: "100vw",
          transform: "translate(0, 0) rotate(-45deg)",
        });
        space.appendChild(star);
        setTimeout(() => star.remove(), 2000);
      }

      // === Rotation & Zoom Handling ===
      let rotateX = 0,
        rotateY = 0,
        zoom = 0;
      let isDragging = false,
        lastX = 0,
        lastY = 0;

      function updateTransform() {
        space.style.transform = `rotateX(${rotateX}deg) rotateY(${rotateY}deg) translateZ(${zoom}px)`;
      }

      document.addEventListener("mousedown", (e) => {
        isDragging = true;
        lastX = e.clientX;
        lastY = e.clientY;
        document.body.style.cursor = "grabbing";
      });

      document.addEventListener("mouseup", () => {
        isDragging = false;
        document.body.style.cursor = "grab";
      });

      document.addEventListener("mousemove", (e) => {
        if (!isDragging) return;
        const dx = e.clientX - lastX;
        const dy = e.clientY - lastY;
        rotateY += dx * 0.15;
        rotateX -= dy * 0.15;
        rotateX = Math.max(-60, Math.min(60, rotateX));
        rotateY = Math.max(-180, Math.min(180, rotateY));
        updateTransform();
        lastX = e.clientX;
        lastY = e.clientY;
      });

      document.addEventListener("wheel", (e) => {
        zoom += e.deltaY * -0.5;
        zoom = Math.max(-3000, Math.min(1000, zoom));
        updateTransform();
      });

      // Touch support
      let touchStartX = 0,
        touchStartY = 0;
      document.addEventListener("touchstart", (e) => {
        if (e.touches.length === 1) {
          touchStartX = e.touches[0].clientX;
          touchStartY = e.touches[0].clientY;
        }
      });

      document.addEventListener("touchmove", (e) => {
        if (e.touches.length === 1) {
          const dx = e.touches[0].clientX - touchStartX;
          const dy = e.touches[0].clientY - touchStartY;
          rotateY += dx * 0.15;
          rotateX -= dy * 0.15;
          rotateX = Math.max(-60, Math.min(60, rotateX));
          rotateY = Math.max(-180, Math.min(180, rotateY));
          updateTransform();
          touchStartX = e.touches[0].clientX;
          touchStartY = e.touches[0].clientY;
        }
      });

      // === Initialize ===
      createStars();
      setInterval(createHeart, 300);
      setInterval(createFallingText, 600);
      setInterval(createShootingStar, 3000);
    </script>
  </body>
</html>
