<!DOCTYPE html>
<html lang="vi">
  <head>
    <meta charset="UTF-8" />
    <title>Anh Y√™u √Ånh ‚ù§Ô∏è</title>
    <style>
      html,
      body {
        margin: 0;
        padding: 0;
        height: 100%;
        overflow: hidden;
        background: black;
        perspective: 1200px;
        cursor: grab;
        touch-action: none;
      }
      .scene {
        width: 100%;
        height: 100%;
        position: relative;
        transform-style: preserve-3d;
      }
      .space {
        width: 100%;
        height: 100%;
        position: absolute;
        top: 0;
        left: 0;
        transform-style: preserve-3d;
        will-change: transform;
      }
      .heart,
      .falling-text,
      .star {
        position: absolute;
        transform-style: preserve-3d;
        user-select: none;
      }
      @keyframes sparkle {
        0% {
          opacity: 0.3;
          box-shadow: 0 0 5px white;
        }
        50% {
          opacity: 1;
          box-shadow: 0 0 15px white;
        }
        100% {
          opacity: 0.3;
          box-shadow: 0 0 5px white;
        }
      }
      .star {
        background: white;
        border-radius: 50%;
        opacity: 0.5;
        animation: sparkle 1s infinite alternate;
      }
      .shooting-star {
        width: 100px;
        height: 2px;
        background: linear-gradient(-45deg, white, transparent);
        animation: shooting 1.5s linear forwards;
        position: absolute;
        transform: rotate(-45deg);
        opacity: 0.8;
      }
      @keyframes shooting {
        0% {
          transform: translate(100vw, -10vh) rotate(-45deg);
          opacity: 1;
        }
        100% {
          transform: translate(-20vw, 100vh) rotate(-45deg);
          opacity: 0;
        }
      }
      .heart {
        font-size: 20px;
        font-weight: 900;
        color: #ff2d55;
        text-shadow: 0 0 8px #ff2d55, 0 0 15px #ff2d55, 0 0 20px #ff2d55,
          0 0 30px #ff6ec7, 0 0 40px #ff6ec7, 0 0 50px #ff6ec7;
        animation: fallHeart linear forwards;
      }
      @keyframes fallHeart {
        0% {
          transform: translateY(0) rotateY(0deg);
        }
        100% {
          transform: translateY(100vh) rotateY(360deg);
          opacity: 0;
        }
      }
      .falling-text {
        font-family: "Pacifico", cursive;
        font-weight: bold;
        white-space: nowrap;
        text-shadow: 0 0 15px white, 0 0 30px #ff6ec7, 0 0 45px #ff6ec7;
        animation: fallText linear forwards, colorChange 3s infinite alternate;
      }
      @keyframes fallText {
        to {
          transform: translateY(100vh);
          opacity: 0;
        }
      }
      @keyframes colorChange {
        0%,
        100% {
          color: hotpink;
        }
        25%,
        75% {
          color: aqua;
        }
        50% {
          color: white;
        }
      }
    </style>
  </head>
  <body>
    <audio id="background-music" autoplay loop>
      <source src="music.mp3" type="audio/mp3" />
    </audio>
    <div class="scene">
      <div class="space" id="space"></div>
    </div>
    <script>
      const space = document.getElementById("space");

      document.addEventListener(
        "click",
        () => {
          document.getElementById("background-music").play();
        },
        { once: true }
      );

      function createElement(tag, className, styles = {}, text = "") {
        const el = document.createElement(tag);
        el.className = className;
        Object.assign(el.style, styles);
        if (text) el.textContent = text;
        space.appendChild(el);
        return el;
      }

      // === Dust 3D ===
      const dustParticles = [];
      function createDust(count = 500) {
        for (let i = 0; i < count; i++) {
          const div = document.createElement("div");
          div.className = "star";
          const size = Math.random() * 2 + 1;
          Object.assign(div.style, {
            width: `${size}px`,
            height: `${size}px`,
            position: "absolute",
          });
          const p = {
            el: div,
            x: (Math.random() - 0.5) * window.innerWidth * 2,
            y: (Math.random() - 0.5) * window.innerHeight * 2,
            z: Math.random() * 2000 - 1000,
            dx: (Math.random() - 0.5) * 3,
            dy: (Math.random() - 0.5) * 3,
            dz: (Math.random() - 0.5) * 3,
          };
          space.appendChild(div);
          dustParticles.forEach((p) => {
            const sparkleDuration = Math.random() * 1.5 + 0.5; // T·∫°o kho·∫£ng th·ªùi gian ng·∫´u nhi√™n
            p.el.style.animation = `sparkle ${sparkleDuration}s infinite alternate`;
          });
          dustParticles.push(p);
        }
      }
      function updateDust() {
        for (const p of dustParticles) {
          p.x += p.dx;
          p.y += p.dy;
          p.z += p.dz;
          if (
            p.z > 1000 ||
            p.z < -1000 ||
            Math.abs(p.x) > 2000 ||
            Math.abs(p.y) > 2000
          ) {
            p.x = (Math.random() - 0.5) * window.innerWidth * 2;
            p.y = (Math.random() - 0.5) * window.innerHeight * 2;
            p.z = Math.random() * 2000 - 1000;
          }
          p.el.style.transform = `translate3d(${p.x}px, ${p.y}px, ${p.z}px)`;
        }
        requestAnimationFrame(updateDust);
      }

      createDust();
      updateDust();

      // === Heart & Text ===
      const messages = [
        "Y√™u √Ånh‚ô°",
        "Anh y√™u em‚ô°",
        "N·ªù ƒê·∫°t ‚ô° N·ªù √Ånh",
        "Ti·ªÉu h·∫Øc ‚ô° Ti·ªÉu b·∫°ch",
        "Love you so much‚ô°",
      ];
      let lastTime = 0;

      function animate(timestamp) {
        if (timestamp - lastTime > 600) {
          createHeart();
          createFallingText();
          lastTime = timestamp;
        }
        requestAnimationFrame(animate);
      }

      function createHeart() {
        const el = createElement(
          "div",
          "heart",
          {
            left: `${Math.random() * 100}vw`,
            top: `${Math.random() * -20}vh`,
            fontSize: `${Math.random() * 20 + 10}px`,
            color: Math.random() > 0.5 ? "red" : "pink",
            animationDuration: `${Math.random() * 5 + 5}s`,
            transform: `translateZ(${Math.random() * 2000 - 1000}px)`,
          },
          "ìÜ©üíóìÜ™"
        );
        setTimeout(() => el.remove(), 10000);
      }

      function createFallingText() {
        const el = createElement(
          "div",
          "falling-text",
          {
            left: `${Math.random() * 90}vw`,
            top: `${Math.random() * -20}vh`,
            fontSize: `${Math.random() * 50 + 20}px`,
            animationDuration: `${Math.random() * 5 + 5}s`,
            transform: `translateZ(${Math.random() * 2000 - 1000}px)`,
          },
          messages[Math.floor(Math.random() * messages.length)]
        );
        setTimeout(() => el.remove(), 10000);
      }

      // === Shooting star ===
      function createShootingStar() {
        const el = createElement("div", "shooting-star", {
          top: "0",
          left: "100vw",
        });
        setTimeout(() => el.remove(), 2000);
      }
      setInterval(createShootingStar, 300000); // 5 ph√∫t

      // === Camera Control ===
      let rotateX = 0,
        rotateY = 0,
        zoom = 0;
      let targetRotateX = 0,
        targetRotateY = 0,
        targetZoom = 0;
      let isDragging = false,
        lastX = 0,
        lastY = 0;

      function lerp(start, end, t) {
        return start + (end - start) * t;
      }

      function updateTransform() {
        rotateX = lerp(rotateX, targetRotateX, 0.15);
        rotateY = lerp(rotateY, targetRotateY, 0.15);
        zoom = lerp(zoom, targetZoom, 0.15);
        space.style.transform = `rotateX(${rotateX}deg) rotateY(${rotateY}deg) translateZ(${zoom}px)`;
        requestAnimationFrame(updateTransform);
      }

      document.addEventListener("mousedown", (e) => {
        isDragging = true;
        lastX = e.clientX;
        lastY = e.clientY;
        document.body.style.cursor = "grabbing";
      });
      document.addEventListener("mouseup", () => {
        isDragging = false;
        document.body.style.cursor = "grab";
      });
      document.addEventListener("mousemove", (e) => {
        if (!isDragging) return;
        const dx = e.clientX - lastX;
        const dy = e.clientY - lastY;
        targetRotateY += dx * 0.15;
        targetRotateX -= dy * 0.15;
        targetRotateX = Math.max(-60, Math.min(60, targetRotateX));
        targetRotateY = Math.max(-180, Math.min(180, targetRotateY));
        lastX = e.clientX;
        lastY = e.clientY;
      });

      document.addEventListener("wheel", (e) => {
        targetZoom += e.deltaY * -0.5;
        targetZoom = Math.max(-3000, Math.min(1000, targetZoom));
      });

      // Touch control
      let touchStartX = 0,
        touchStartY = 0;
      document.addEventListener("touchstart", (e) => {
        if (e.touches.length === 1) {
          touchStartX = e.touches[0].clientX;
          touchStartY = e.touches[0].clientY;
        }
      });
      document.addEventListener("touchmove", (e) => {
        if (e.touches.length === 1) {
          const dx = e.touches[0].clientX - touchStartX;
          const dy = e.touches[0].clientY - touchStartY;
          targetRotateY += dx * 0.15;
          targetRotateX -= dy * 0.15;
          targetRotateX = Math.max(-60, Math.min(60, targetRotateX));
          targetRotateY = Math.max(-180, Math.min(180, targetRotateY));
          touchStartX = e.touches[0].clientX;
          touchStartY = e.touches[0].clientY;
        }
      });

      requestAnimationFrame(updateTransform);
      requestAnimationFrame(animate);
    </script>
  </body>
</html>
